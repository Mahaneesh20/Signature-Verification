<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registration & Login</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- <link rel="stylesheet" href="sign.css"> -->

<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');
*{
    padding: 0;
    margin: 0;
    box-sizing: border-box;
    font-family: "Poppins", serif;
}



.container{
    background-color: #fff;
    width: 450px;
    padding: 1.5rem;
    margin: 50px auto;
    border-radius: 10px;
    box-shadow: 0 20px 35px rgba(0,0,1,0.9);
    /* position: relative;
    left: 400px; */
}

form{
    margin: 0 2rem;
}

.form-title{
    font-size: 1.5rem;
    font-weight: bold;
    text-align: center;
    padding: 1.3rem;
    margin-bottom: 0.4rem;
}

input{
    color: inherit;
    width: 100%;
    background-color:transparent;
    border: none;
    border-bottom: 1px solid #757575;
    padding-left: 1.5rem;
    font-size: 15px;
}

.input-group{
    padding: 1% 0;
    position: relative;
}

.input-group i{
    position: absolute;
    color: black;
    margin-top: 5px;
}

input:focus{
    background-color:transparent;
    outline: transparent;
    border-bottom: 2px solid hsl(327,90%,28%);
}

input::placeholder{
    color: transparent;
}

label{
    color: #757575;
    position: relative;
    left: 1.2em;
    top: -1.5em;
    cursor:auto;
    transition: 0.3s ease all;
}

input:focus~label,input:not(:placeholder-shown)~label{
   top: -3em;
   color: hsl(327,90%,28%);
   font-size: 15px;
}

.recover {
    text-align:right;
    font-size: 1rem;
    margin-bottom: 1rem;
}

.recover a{
    text-decoration: none;
    color: rgb(125,125,235);
}

.recover a:hover{
    color: blue;
    text-decoration: underline;
}

.btn{
    font-size: 1.1rem;
    padding: 8px 0;
    border-radius: 5px;
    outline: none;
    border: none;
    width: 100%;
    background-color:rgb(125,125,235);
    color: #fff;
    cursor: pointer;
    transition: 0.9s;
}

.btn:hover{
    background-color:#07001f;
}

.or{
    text-align: center;
    margin-top: 0.5rem;
    font-size: 1.1rem;
}

.icons{
    text-align: center;
}


.icons i{
    color: rgb(125,125,235);
    padding: 0.8rem 1.5rem;
    border-radius: 10px;
    font-size: 1.5rem;
    cursor: pointer;
    border: 2px solid #dfe9f5;
    margin: 0 15px;
    transition: 1s;
}

.icons i:hover{
    background-color:#07001f;
    font-size: 1.6rem;
    border: 2px solid rgb(125,125,235);
}

.links{
    display: flex;
    justify-content: space-around;
    padding: 0 4rem;
    margin-top: 0.9rem;
    font-weight: bold;
}

button{
    color: rgb(125,125,235);
    border: none;
    background-color:transparent;
    font-size: 1rem;
    font-weight: bold;
    cursor: pointer;
}

button:hover{
    text-decoration: underline;
    color: blue;
}
</style>
</head>

<body>
  <div class="container" id="signup" style="display: none;">
    <h1 class="form-title">SignUp</h1>
    <form method="post" action="/api/signup" id="signUpForm" >
      
      <div class="input-group">
        <i class="fas fa-user"></i>
        <input type="text" name="fName" id="fName" placeholder="First Name" required />
        <label for="fname">First Name</label>
      </div>
      <div class="input-group">
        <i class="fas  fa-user"></i>
        <input type="text" name="lName" id="lName" placeholder="Last Name" required />
        <label for="lName">Last Name</label>
      </div>
      <div class="input-group">
        <i class="fas fa-envelope"></i>
        <input type="text" name="email" id="email" placeholder="Email" required />
        <label for="email">Employee ID</label>
      </div>
      <div class="input-group">
        <i class="fas fa-lock"></i>
        <input type="password" name="password" id="password" placeholder="Password" required />
        <label for="password">Password</label>
      </div>

      
<br>
      <input type="submit" class="btn" value="Sign Up" name="signUp">
    </form>
    <p id="message"></p>
    <div class="links">
      <p>Already Have Account ?</p>
      <button id="signInButton">Sign In</button>
    </div>
  </div>
  <div class="container" id="signIn" style="position: relative; top:100px;">
    
    <h1 class="form-title">Login</h1>
  
    <form method="post" action="/api/Login" id="login">

      <div class="input-group">
        <i class="fas fa-envelope"></i>
        <input type="text" name="emp_id" id="emp_id" placeholder="Email" required />
        <label for="email">Employee ID</label>
      </div>
      <div class="input-group">
        <i class="fas fa-lock"></i>
        <input type="password" name="password" id="Password" placeholder="Password" required />
        <label for="password">Password</label>
      </div> 
      <!-- <div class="recover">
        <button id="forgotPasswordLink">Forgot Password</button>
      </div> -->
      <input type="submit" class="btn" value="Sign In" name="signIn">
    </form>
    <div class="links">
      <p>Don't have account yet ?</p>
      <button id="signUpButton">Sign Up</button>
    </div>
  </div>

  <!-- <div class="container" id="forgotPassword" style="display: none;position: relative;top: 100px ;">
    <h1 class="form-title">Forgot Password</h1>
    <form method="post" action="/api/forgotPassword" id="forgot_password">
      <div class="input-group">
        <i class="fas fa-envelope"></i>
        <input type="email" name="email" id="resetEmail" placeholder="Email" required />
        <label for="resetEmail">Enter Your Email</label>
        <div class="input-group">
          <i class="fas fa-lock"></i>
          <input type="password" name="password" id="resetloginPassword" placeholder="Create new Password" required />
          <label for="resetloginPassword">New Password</label>
        </div>
        <div class="input-group">
          <i class="fas fa-lock"></i>
          <input type="password" name="password" id="resetloginPassword1" placeholder="Enter again Password" required />
          <label for="resetloginPassword">Confirm Password</label>
        </div>

      </div>
      <p id="message1"></p>
      <input type="submit" class="btn" value="Reset Password" name="resetPassword">
    </form> -->

    <!-- <div class="links">
      <p>Remembered your password?</p>
      <button id="backToSignInButton">Sign In</button>
    </div> -->
  <!-- </div> -->

  <script>
    const signUpButton = document.getElementById('signUpButton');
    const signInbuttton = document.getElementById('signInButton');
    const signInForm = document.getElementById('signIn');
    const signUpForm = document.getElementById('signup');
    // const  forgotPasswordLink= document.getElementById('forgotPasswordLink');
    // const forgotPasswordForm = document.getElementById('forgotPassword');

  //   document.getElementById('signature').addEventListener('change', function(event) {
  // const fileInput = event.target;
  // const label = document.getElementById('signatureLabel');

//   if (fileInput.files.length > 0) {
//     // Get the uploaded file name
//     const fileName = fileInput.files[0].name;
//     label.textContent = fileName; // Update the label text
//   } else {
//     label.textContent = "Upload Your Signature"; // Reset label text if no file is selected
//   }
// });


    signUpButton.addEventListener('click', function () {
      signInForm.style.display = "none";
      signUpForm.style.display = "block";
    })

    signInbuttton.addEventListener('click', function () {
      signInForm.style.display = "block";
      signUpForm.style.display = "none"
    })

    // forgotPasswordLink.addEventListener('click', function () {
      
    //   signInForm.style.display = "none";
    //   signUpForm.style.display = "none";
    //   forgotPasswordForm.style.display = "block";
    // });

    // backToSignInButton.addEventListener('click', function () {
    //   signInForm.style.display = "block";
    //   signUpForm.style.display = "none";
    //   forgotPasswordForm.style.display = "none";
    // });


    document.getElementById('signUpForm').addEventListener('submit', async function(event) {
      event.preventDefault();
      
      const fname = document.getElementById('fName').value;
      const lname = document.getElementById('lName').value;
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const message = document.getElementById('message');

      const formData = {
          fname: fname,
          lname: lname,
          emp_id: email,
          pass: password
      };

      try {
          const response = await fetch('/api/signup', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',  // Tell the server you're sending JSON
              },
              body: JSON.stringify(formData),  // Convert the object to a JSON string
          });

          const data = await response.json();

          if (!data.success) {
              message.textContent = 'User already exists';
              message.style.color = 'red';
          } else {
              message.textContent = 'Registration successful';
              message.style.color = 'green';
              setTimeout(() => {
                  window.location.href = '/api/login';  // Change to your login URL if different
              }, 1000);
          }
      } catch (error) {
          console.error('Error:', error);
          message.textContent = 'Something went wrong';
          message.style.color = 'red';
      }
  });

    //           document.getElementById('forgot_password').addEventListener('submit', async function(event) {
    // event.preventDefault();
    
    // // Retrieve input values correctly
    // let email = document.getElementById('resetEmail').value;
    // let new_password = document.getElementById("resetloginPassword").value;
    // let message = document.getElementById("message1");  // Correct the typo in the ID
    
    // Send a POST request to the server
//     const response = await fetch('/api/forgotPassword', {
//       method: 'POST',
//       headers: {
//           'Content-Type': 'application/json',
//       },
//       body: JSON.stringify({ email: email, new_password: new_password })
//     });

//     const data = await response.json();
    
//     if (data.success) {
//         message.textContent = 'Password changed';
//         message.style.color = 'green';
//         setTimeout(() => {
//             window.location.href = '/api/login';
//         }, 1000);
//     } else {
//         message.textContent = 'Password not changed';
//         message.style.color = 'red';
//     }
// });



document.getElementById('login').addEventListener('submit', async function(event) {
            event.preventDefault();
            let emp_id = document.getElementById("emp_id").value;
            let pass = document.getElementById("Password").value;
            const response = await fetch('/api/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ emp_id: emp_id , pass: pass }),
            });
            const data = await response.json();
            if (data.success) {
                        window.location.href = '/api/dashboard';
            } else {
                alert("Invalid login");
            }
        });
  </script>
</body>

</html>